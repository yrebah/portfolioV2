window.onload=(()=>{setFirstConnectionLocalStorage(),setAcceptCookiesLocalStorage(),getAvailablesLanguages(),getAvailablesThemes(),getThemeChoice(),setMainLinks(),getCurrentSectionInViewport(),setOpenResume(),setScrollTopLinkHome(),setParallaxEffectBlockSkills(),setCookiesBtnFunction(),showStarterModals(),setOpenContactFormFunction(),setValidateContactFormFunctions(),setMessageHTML(),setMaxCharLengthValue(),setCloseModalContactFunctions(),setOpenModalSettingsFunctions(),setCloseModalSettingsFunctions(),setModalWelcomeBackFunctions(),setHtmlTranslations()}),window.onscroll=(()=>{getCurrentSectionInViewport(),setParallaxEffectHome()});const showStarterModals=()=>{-1==localStorage.getItem("acceptCookies")?showModal("#modal-cookies"):showModal("#modal-welcome-back")},setThemesChoicesIntoList=e=>{const t=document.querySelector("#list-themes-choice");e.forEach(e=>{t.innerHTML+=`<li id="${e.id}" class="theme-choice flex-value-20">\n                                    <div data-tr="${e.tr}"></div>\n                                </li>`})},getSectionsInfos=()=>{const e=[];return document.querySelectorAll(".section").forEach(t=>{e.push({id:t.id,position:parseInt(t.getAttribute("data-position"))})}),e},setMainLinks=()=>{const e=getSectionsInfos().slice(1);let t='<li>\n                    <a id="link-home" class="link hide-s" data-tr-title="home">\n                        <i class="fas fa-home"></i>\n                    </a>\n                </li>';e.forEach(e=>{t+=`<li>\n                    <a id="link-${e.id}" class="link hide-s" href="#${e.id}" data-tr="${e.id}"></a>\n                </li>`}),t+='<li>\n                <i id="btn-get-settings" class="fas fa-cog link" style="font-size:18px;" data-tr-title="settings"></i>\n            </li>\n            <li>\n                <a href="https://github.com/yrebah/portfolioV2/tree/main/vs_01" target="_blank" class="link" style="font-size:18px;" data-tr-title="githubProjectLink">\n                    <i class="fab fa-github"></i>\n                </a>\n            </li>\n            <li class="container-select-language"></li>',document.querySelector(".container-links").innerHTML=t},setSectionHomeHTML=e=>{let t=`<video id="video-home-landing" class="video-home-landing hide-l" autoplay loop>\n                    <source src="./videos/${null!=e?e:"classic"}.mp4" type="video/mp4">\n                </video>\n                <div class="container">\n                    <div class="wrapper">\n                        <div>\n                            <h1 data-tr="portfolioTitle" class="primary-text-shadow"></h1>\n                            <h2 data-tr="profession" class="primary-text-shadow"></h2>\n                        </div>\n                        <p data-tr="welcomeText"></p>\n                        <a id="btn-get-resume" class="btn-a" data-tr="getResume"></a>\n                    </div>\n                </div>`;document.querySelector("#home").innerHTML=t,setHtmlTranslations()},setThemeChoice=e=>{document.querySelector("#linkTheme").setAttribute("href",`./themes/${e}.css`),localStorage.setItem("theme",e),setSectionHomeHTML(e),setParallaxEffectHome(),setActiveClassName(`#${e}`,".theme-choice","active")},getThemeChoice=()=>{let e=localStorage.getItem("theme");setThemeChoice(null!=e?e:"classic")},setThemeChoiceFunctions=()=>{document.querySelectorAll(".theme-choice").forEach(e=>{e.addEventListener("click",t=>{setThemeChoice(e.id)})})},setOpenModalSettingsFunctions=()=>{document.querySelector("#btn-get-settings").addEventListener("click",()=>{showModal("#modal-settings")})},setCloseModalSettingsFunctions=()=>{const e=document.querySelector("#modal-settings"),t=document.querySelector("#modal-settings .container");e.addEventListener("click",e=>{t.contains(e.target)||hideModal("#modal-settings")})},setParallaxEffectHome=()=>{let e=window.scrollY;const t=document.querySelector("#home .container .wrapper"),a=document.querySelector(".video-home-landing");a.style.transform=`translate(-${e}px, ${1.2*e}px) scale(${1+e/300})`,a.style.opacity=`${1-e/500}`,t.style.opacity=`${1-e/500}`,a.style.opacity<0&&t.style.opacity<0?(a.style.display="none",t.style.display="none"):a.style.opacity>0&&t.style.opacity>0&&(a.style.display="block",t.style.display="flex")},startVideoHomeLanding=()=>{document.querySelector("#video-home-landing").play()},setScrollTopLinkHome=()=>{document.querySelector("#link-home").addEventListener("click",()=>scrollToTop())};async function getCurrentSectionInViewport(){const e=document.querySelector("#section-name-rwd"),t=await getTranslations();document.querySelectorAll(".section").forEach(a=>{isElementXPercentInViewport(`#${a.id}`,20)&&(setActiveClassName(`#link-${a.id}`,".header nav ul li .link","active"),e.innerHTML=t[a.id],document.querySelector(`#${a.id}`).style.opacity="1",document.querySelector(`#${a.id}`).style.transform="translateX(0px)")})}const setOpenResume=()=>{document.querySelector("#btn-get-resume").addEventListener("click",()=>{window.open("./doc/CV-Yoann_REBAH.pdf")})},setParallaxEffectBlockSkills=()=>{document.querySelectorAll(".block-skills .wrapper").forEach(e=>{e.addEventListener("mousemove",t=>{let a=t.target.getBoundingClientRect(),o=(t.clientX-a.left).toFixed(0),n=(t.clientY-a.top).toFixed(0);e.querySelector(".container").style.transform=`translate(-${o/10}px, -${n/8}px)`})})},getNextElements=()=>{let e=document.querySelector("#roadmap .wrapper .container-titles .title.active"),t=document.querySelector("#roadmap .wrapper .container-images .image.active"),a=document.querySelector("#roadmap .wrapper .container-paragraphs .paragraph.active"),o=document.querySelector("#roadmap .wrapper .container-years .year.active"),n=document.querySelector("#roadmap .wrapper .container-arrows .container .container-counter .counter.active"),l=e.nextElementSibling,s=t.nextElementSibling,c=a.nextElementSibling,r=o.nextElementSibling,i=n.nextElementSibling;e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),o.classList.remove("active"),n.classList.remove("active"),l.classList.add("active"),s.classList.add("active"),c.classList.add("active"),r.classList.add("active"),i.classList.add("active"),checkFirstOrLastElement(),setYearValue()},getPreviousElements=()=>{let e=document.querySelector("#roadmap .wrapper .container-titles .title.active"),t=document.querySelector("#roadmap .wrapper .container-images .image.active"),a=document.querySelector("#roadmap .wrapper .container-paragraphs .paragraph.active"),o=document.querySelector("#roadmap .wrapper .container-years .year.active"),n=document.querySelector("#roadmap .wrapper .container-arrows .container .container-counter .counter.active"),l=e.previousElementSibling,s=t.previousElementSibling,c=a.previousElementSibling,r=o.previousElementSibling,i=n.previousElementSibling;e.classList.remove("active"),t.classList.remove("active"),a.classList.remove("active"),o.classList.remove("active"),n.classList.remove("active"),l.classList.add("active"),s.classList.add("active"),c.classList.add("active"),r.classList.add("active"),i.classList.add("active"),checkFirstOrLastElement(),setYearValue()},setYearValue=()=>{let e=document.querySelector("#roadmap .wrapper .container-years .year-value"),t=document.querySelector("#roadmap .wrapper .container-years .year.active");"8"==t.innerHTML||"9"==t.innerHTML?e.innerHTML="201":e.innerHTML="202"},setCounterValue=()=>{const e=document.querySelectorAll(".container-counter .roadmap-item").length;document.querySelector(".container-counter .counter-value").innerHTML=`/${e}`};document.querySelector("#arrow-next").addEventListener("click",()=>{getNextElements()}),document.querySelector("#arrow-previous").addEventListener("click",()=>{getPreviousElements()});const checkFirstOrLastElement=()=>{const e=document.querySelectorAll(".roadmap-item.title").length-1;document.querySelectorAll(".roadmap-item.title")[0].classList.contains("active")&&document.querySelectorAll(".roadmap-item.image")[0].classList.contains("active")&&document.querySelectorAll(".roadmap-item.paragraph")[0].classList.contains("active")&&document.querySelectorAll(".roadmap-item.year")[0].classList.contains("active")?document.querySelector("#arrow-previous").classList.add("disabled"):document.querySelector("#arrow-previous").classList.remove("disabled"),document.querySelectorAll(".roadmap-item.title")[e].classList.contains("active")&&document.querySelectorAll(".roadmap-item.image")[e].classList.contains("active")&&document.querySelectorAll(".roadmap-item.paragraph")[e].classList.contains("active")&&document.querySelectorAll(".roadmap-item.year")[e].classList.contains("active")?document.querySelector("#arrow-next").classList.add("disabled"):document.querySelector("#arrow-next").classList.remove("disabled")},appendSelectLanguage=e=>{document.querySelectorAll(".container-select-language").forEach(t=>{null!=t&&t.append(SelectLanguage(e))})},setCookiesBtnFunction=()=>{document.querySelector("#btn-accept-cookies").addEventListener("click",()=>{hideModal("#modal-cookies"),localStorage.setItem("acceptCookies",1),startVideoHomeLanding()})},setOpenContactFormFunction=()=>{document.querySelector("#btnOpenContactForm").addEventListener("click",()=>{showModal("#modal-contact-form")})},setMessageToLocalStorage=(e,t,a)=>{localStorage.setItem("messageLocalDate",e),localStorage.setItem("messageLocalTime",t),localStorage.setItem("messageText",a)},setMessageHTML=()=>{let e=localStorage.getItem("messageLocalDate"),t=localStorage.getItem("messageLocalTime"),a=localStorage.getItem("messageText");if(null!=e&&null!=t&&null!=a){null!=document.querySelector("#message")&&document.querySelector("#message").remove();let o=`<li id="message" class="bubble-message receive">\n                <div class="date">Le ${e} Ã  ${t}</div>\n                ${a}\n            </li>`;document.querySelector(".list-message").innerHTML+=o}},setValidateContactFormFunctions=()=>{const e=document.querySelector("#user-subject"),t=document.querySelector("#user-mail"),a=document.querySelector("#user-message"),o=document.querySelector("#btn-send-mail"),n=document.querySelector("#btn-clear-message"),l=document.querySelectorAll(".input-contact-form");o.addEventListener("click",()=>{if(e.value&&t.value&&a.value&&a.value)if(mailIsValid(t.value)){let o=(new Date).toLocaleString(),n=o.split(",")[0],s=o.split(",")[1],c=t.value,r=e.value,i=a.value;$.post("./request.php",{request:"setMessage",mail:c,subject:r,message:i},function(e){"success"==e?(setInputsError(l),clearInputsValue(l),hideModal("#modal-contact-form"),setMessageToLocalStorage(n,s,i),setMessageHTML(),Notif("success","yourMessageSentSuccess")):Notif("error","yourMessageSentError")})}else setUnvalidInputMail(t),Notif("error","mailIsNotValid");else setInputsError(l),Notif("error","pleaseEnterAllFields")}),a.addEventListener("input",()=>{updateInputMessageLengthValue(a)}),n.addEventListener("click",()=>{a.value="",a.focus(),updateInputMessageLengthValue(a)})},updateInputMessageLengthValue=e=>{document.querySelector("#char-length-value").innerHTML=`${e.value.length}`},setMaxCharLengthValue=()=>{const e=document.querySelector("#user-message");document.querySelector("#max-char-value").innerHTML=` / ${e.getAttribute("maxlength")}`},setCloseModalContactFunctions=()=>{const e=document.querySelector("#user-message"),t=document.querySelector("#modal-contact-form"),a=document.querySelector("#modal-contact-form .container");t.addEventListener("click",t=>{a.contains(t.target)||(e.value.length>0?NotifConfirmation("cancelEntry?",()=>{hideModal("#modal-contact-form")}):hideModal("#modal-contact-form"))})},setModalWelcomeBackFunctions=()=>{const e=document.querySelector("#modal-welcome-back"),t=document.querySelector("#modal-welcome-back .container"),a=document.querySelector("#btn-change-theme"),o=document.querySelector("#btn-no-thanks");e.addEventListener("click",e=>{t.contains(e.target)||(hideModal("#modal-welcome-back"),startVideoHomeLanding())}),a.addEventListener("click",e=>{hideModal("#modal-welcome-back"),showModal("#modal-settings"),startVideoHomeLanding()}),o.addEventListener("click",()=>{hideModal("#modal-welcome-back"),startVideoHomeLanding()})};async function setHtmlTranslations(){const e=await getTranslations();document.querySelectorAll("[data-tr]").forEach(t=>{null!=t&&("input"===t.tagName.toLowerCase()||"textarea"===t.tagName.toLowerCase()?t.placeholder=e[t.getAttribute("data-tr")]:t.innerHTML=e[t.getAttribute("data-tr")])}),document.querySelectorAll("[data-tr-title]").forEach(t=>{null!=t&&(t.title=e[t.getAttribute("data-tr-title")])}),document.querySelectorAll(".select-language").forEach(e=>{null!=e&&(e.value=localStorage.getItem("lang"))}),setYearValue(),setCounterValue()}